<!doctype html>
<html>
  <head>
    <title>Online Date Viewer</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
  </head>
  <body>
<div id="container" style="min-width:310px; height:400px; margin:0px"></div>
    <script>
		var socket = io();
		$(function () {
    $(document).ready(function () {
        Highcharts.setOptions({
            global: {
                useUTC: false
            }
        });

        Highcharts.chart('container', {
            chart: {
                type: 'scatter',
                animation: false, // don't animate in old IE
                marginRight: 10,
                events: {
                    load: function () {
                        var series = this.series[0];
                        socket.on('chart value', function(msg){
                        	var data = JSON.parse(msg);
                        	var yData;
                       		yData = data.energy;
                        	
                        	var x = data.timestamp, 
								y =  yData;
                        	var shift = false;
                        	if(series.data.length >= 100){
                        		shift = true;
                        	}
                        	console.log(x + ";" + y);
                        	series.addPoint([x, y], true, shift);
                  		});
                    }
                }
            },
            title: {
                text: 'Online data'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150
            },
            yAxis: {
                title: {
                    text: 'Value'
                }
            },
            tooltip: {
                enabled: false
            },
            legend: {
                enabled: false
            },
            exporting: {
                enabled: false
            },
            series: [{
                name: 'Random data',
                data: []
            }]
        });
    });
});
	</script>
  </body>
</html>